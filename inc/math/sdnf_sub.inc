;-----------------------------------------------------------------------------------------------------------------------
;Владельцем данного исходного кода является Удовиченко Константин Александрович, емайл:w5277c@gmail.com, по всем
;правовым вопросам обращайтесь на email.
;-----------------------------------------------------------------------------------------------------------------------
;07.10.2019  w5277c@gmail.com        Начало
;01.08.2020  w5277c@gmail.com        Разбиение на файлы
;-----------------------------------------------------------------------------------------------------------------------
.ifdef DEF_CORE5277_SDNF_SUB
.else
.set DEF_CORE5277_SDNF_SUB = 1

.include	"./inc/math/sdnf_add.inc"

;--------------------------------------------------------
CORE5277_SDNF_SUB:													;Signed Digital aNd Fractional
;--------------------------------------------------------
;Разница знаковых целых с дробной частью (X - Y)
;IN: X, Y
;OUT: X
;-START--------------------------------------------------
	;Проверка на корректность значений
	CPI YH,0xff
	BRNE PC+0x04
	CPI YL,0xff
	BRNE PC+0x02
	RJMP _CORE5277_SDNF_ADD__ERROR

	PUSH TEMP_H
	PUSH TEMP_L
	LDI TEMP_H,0x01
	LSL YL
	ROL TEMP_L
	EOR TEMP_H,TEMP_L
	LSR TEMP_H
	ROR YL
	POP TEMP_L
	POP TEMP_H
	RJMP CORE5277_SDNF_ADD
.endif
