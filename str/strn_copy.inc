;-----------------------------------------------------------------------------------------------------------------------
;Файл распространяется под лицензией GPL-3.0-or-later, https://www.gnu.org/licenses/gpl-3.0.txt
;-----------------------------------------------------------------------------------------------------------------------
;29.04.2021	w5277c@gmail.com			Начало
;01.10.2021	w5277c@gmail.com			Y->Z
;-----------------------------------------------------------------------------------------------------------------------
;TODO копирвание из FLASH?
;-----------------------------------------------------------------------------------------------------------------------
.ifdef DEF_STRN_COPY
.else
.set DEF_STRN_COPY = 1

.if REPORT_INCLUDES == 0x01
.message "included STRN_COPY"
.endif

;--------------------------------------------------------
STRN_COPY:
;--------------------------------------------------------
;Копирование строки
;IN: Z-SRC адрес, X-DST адрес, LOOP_CNTR-макс. длина
;--------------------------------------------------------
	PUSH_Z
	PUSH_X
	PUSH TEMP
	PUSH LOOP_CNTR

STRN_COPY__LOOP:
	LD TEMP,Z+
	ST X+,TEMP
	CPI TEMP,0x00
	BREQ STRN_COPY__END
	DEC LOOP_CNTR
	BRNE STRN_COPY__LOOP

STRN_COPY__END:
	POP LOOP_CNTR
	POP TEMP
	POP_X
	POP_Z
	RET
.endif
